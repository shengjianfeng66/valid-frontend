// Mock markdown content for preview/demo
const mockMarkdown = `
# ç”¨æˆ·è¡Œä¸ºæ·±åº¦åˆ†ææŠ¥å‘Š

> **æŠ¥å‘Šå‘¨æœŸ**ï¼š2025å¹´10æœˆ21æ—¥ - 10æœˆ27æ—¥  
> **åˆ†æå¸ˆ**ï¼šäº§å“æ•°æ®å›¢é˜Ÿ  
> **æ›´æ–°æ—¶é—´**ï¼š2025-10-29 11:30

---

## ç›®å½•

1. [æ‰§è¡Œæ‘˜è¦](#1-æ‰§è¡Œæ‘˜è¦)
2. [æ ¸å¿ƒæŒ‡æ ‡åˆ†æ](#2-æ ¸å¿ƒæŒ‡æ ‡åˆ†æ)
3. [ç”¨æˆ·è¡Œä¸ºæ´å¯Ÿ](#3-ç”¨æˆ·è¡Œä¸ºæ´å¯Ÿ)
4. [æŠ€æœ¯å®ç°ç»†èŠ‚](#4-æŠ€æœ¯å®ç°ç»†èŠ‚)
5. [æ•°æ®æ¨¡å‹ä¸ç®—æ³•](#5-æ•°æ®æ¨¡å‹ä¸ç®—æ³•)
6. [ä¼˜åŒ–å»ºè®®](#6-ä¼˜åŒ–å»ºè®®)

---

## 1. æ‰§è¡Œæ‘˜è¦

### 1.1 å…³é”®å‘ç°

æœ¬å‘¨æ ¸å¿ƒæ•°æ®è¡¨ç°è‰¯å¥½ï¼Œä¸»è¦äº®ç‚¹å¦‚ä¸‹ï¼š

- âœ… **ç”¨æˆ·å¢é•¿**ï¼šæ–°å¢ç”¨æˆ·ç¯æ¯”å¢é•¿ **23.4%**ï¼Œåˆ›è¿‘ä¸‰ä¸ªæœˆæ–°é«˜
- âœ… **ç”¨æˆ·ç•™å­˜**ï¼šæ¬¡æ—¥ç•™å­˜ç‡æå‡è‡³ **38.2%**ï¼Œè¶…å‡ºè¡Œä¸šåŸºå‡†çº¿
- âš ï¸ **è½¬åŒ–æ¼æ–—**ï¼šæ³¨å†Œæµç¨‹ç¬¬ä¸‰æ­¥æµå¤±ç‡è¾¾ **42%**ï¼Œéœ€é‡ç‚¹ä¼˜åŒ–
- ğŸ“ˆ **æ”¶å…¥æŒ‡æ ‡**ï¼šARPU å€¼å¢é•¿ **15.8%**ï¼Œä»˜è´¹è½¬åŒ–ç‡ç¨³å®šåœ¨ **3.2%**

### 1.2 æˆ˜ç•¥å»ºè®®

åŸºäºæ•°æ®åˆ†æï¼Œæˆ‘ä»¬æå‡ºä»¥ä¸‹ä¸‰å¤§æˆ˜ç•¥æ–¹å‘ï¼š

1. **ç®€åŒ–æ³¨å†Œæµç¨‹** - é¢„è®¡å¯æå‡è½¬åŒ–ç‡ 8-12%
2. **ä¼˜åŒ–é¦–æ¬¡ä½“éªŒ** - é€šè¿‡æ–°æ‰‹å¼•å¯¼é™ä½æ—©æœŸæµå¤±
3. **ä¸ªæ€§åŒ–æ¨è** - æå‡ç”¨æˆ·æ´»è·ƒåº¦å’Œç•™å­˜æ—¶é•¿

> ğŸ’¡ **é‡è¦æç¤º**ï¼šå»ºè®®ä¼˜å…ˆå®æ–½æ³¨å†Œæµç¨‹ä¼˜åŒ–ï¼Œé¢„è®¡å¯åœ¨ä¸¤å‘¨å†…å®Œæˆï¼ŒæŠ•å…¥äº§å‡ºæ¯”æœ€é«˜ã€‚

---

## 2. æ ¸å¿ƒæŒ‡æ ‡åˆ†æ

### 2.1 å¢é•¿æŒ‡æ ‡æ¦‚è§ˆ

#### 2.1.1 ç”¨æˆ·è§„æ¨¡

| æŒ‡æ ‡ | æœ¬å‘¨ | ä¸Šå‘¨ | ç¯æ¯”å˜åŒ– | æœˆåŒæ¯” | ç›®æ ‡è¾¾æˆç‡ |
| :--- | ---: | ---: | :---: | :---: | :---: |
| **æ–°å¢ç”¨æˆ·** | 12,345 | 10,005 | +23.4% â†—ï¸ | +45.2% | 108% |
| **æ´»è·ƒç”¨æˆ·(DAU)** | 56,210 | 53,880 | +4.3% â†—ï¸ | +12.8% | 102% |
| **æœˆæ´»ç”¨æˆ·(MAU)** | 245,680 | 238,120 | +3.2% â†—ï¸ | +18.5% | 105% |
| **ç´¯è®¡æ³¨å†Œ** | 1,234,567 | 1,222,222 | +1.0% | +28.3% | - |

#### 2.1.2 ç•™å­˜åˆ†æ

ä¸åŒæ¸ é“ç”¨æˆ·çš„ç•™å­˜è¡¨ç°å·®å¼‚æ˜æ˜¾ï¼š

| è·å®¢æ¸ é“ | æ¬¡æ—¥ç•™å­˜ | 7æ—¥ç•™å­˜ | 30æ—¥ç•™å­˜ | ç”¨æˆ·LTV |
| :--- | ---: | ---: | ---: | ---: |
| è‡ªç„¶æœç´¢ | 42.3% | 28.5% | 15.2% | Â¥156 |
| å¹¿å‘ŠæŠ•æ”¾ | 35.8% | 22.1% | 11.8% | Â¥98 |
| ç¤¾äº¤æ¨è | 51.2% | 38.7% | 24.5% | Â¥208 |
| å†…å®¹è¥é”€ | 48.9% | 35.2% | 20.1% | Â¥178 |

### 2.2 è½¬åŒ–æ¼æ–—è¯¦æƒ…

#### 2.2.1 æ³¨å†Œæµç¨‹åˆ†æ

ç”¨æˆ·ä»è®¿é—®åˆ°å®Œæˆæ³¨å†Œçš„å„ç¯èŠ‚è½¬åŒ–ç‡ï¼š

\`\`\`
è®¿é—®é¦–é¡µ (100%)
    â†“ 85%
ç‚¹å‡»æ³¨å†Œ (85%)
    â†“ 72%
å¡«å†™ä¿¡æ¯ (61%)
    â†“ 58%  â† âš ï¸ ä¸»è¦æµå¤±ç‚¹
éªŒè¯æ‰‹æœº (35%)
    â†“ 95%
å®Œæˆæ³¨å†Œ (33%)
\`\`\`

**æµå¤±åŸå› åˆ†æï¼š**
- 42% - æ‰‹æœºéªŒè¯ç è¶…æ—¶/å¤±è´¥
- 28% - è¡¨å•å¡«å†™é¡¹è¿‡å¤š
- 18% - éšç§æ”¿ç­–é¡¾è™‘
- 12% - å…¶ä»–åŸå› 

#### 2.2.2 ä»˜è´¹è½¬åŒ–è·¯å¾„

\`\`\`mermaid
graph LR
    A[æ³¨å†Œç”¨æˆ·] -->|15%| B[é¦–æ¬¡ä»˜è´¹]
    A -->|60%| C[æµè§ˆä»˜è´¹åŠŸèƒ½]
    C -->|8%| B
    B -->|45%| D[å¤è´­ç”¨æˆ·]
    D -->|65%| E[é«˜ä»·å€¼ç”¨æˆ·]
\`\`\`

---

## 3. ç”¨æˆ·è¡Œä¸ºæ´å¯Ÿ

### 3.1 ç”¨æˆ·ç”»åƒåˆ†æ

#### 3.1.1 äººå£ç»Ÿè®¡å­¦ç‰¹å¾

**å¹´é¾„åˆ†å¸ƒï¼š**
- 18-24å²ï¼š28.5%
- 25-34å²ï¼š42.3% â­ ä¸»åŠ›ç”¨æˆ·ç¾¤
- 35-44å²ï¼š18.7%
- 45å²ä»¥ä¸Šï¼š10.5%

**åœ°åŸŸåˆ†å¸ƒï¼š**

| åŸå¸‚çº§åˆ« | ç”¨æˆ·å æ¯” | æ´»è·ƒåº¦ | ARPUå€¼ |
| :--- | :---: | :---: | ---: |
| ä¸€çº¿åŸå¸‚ | 35.2% | é«˜ ğŸ”¥ | Â¥128 |
| æ–°ä¸€çº¿åŸå¸‚ | 28.7% | ä¸­é«˜ ğŸ“ˆ | Â¥95 |
| äºŒçº¿åŸå¸‚ | 22.3% | ä¸­ | Â¥76 |
| å…¶ä»–åŸå¸‚ | 13.8% | ä¸­ä½ | Â¥52 |

#### 3.1.2 è¡Œä¸ºç‰¹å¾èšç±»

åŸºäº K-means èšç±»åˆ†æï¼Œæˆ‘ä»¬è¯†åˆ«å‡ºå››ç±»å…¸å‹ç”¨æˆ·ï¼š

1. **æ¢ç´¢å‹ç”¨æˆ·** (32%)
   - é«˜é¢‘è®¿é—®ï¼Œä½è½¬åŒ–
   - å¹³å‡åœç•™æ—¶é•¿ï¼š8.5åˆ†é’Ÿ
   - å»ºè®®ç­–ç•¥ï¼šç²¾å‡†æ¨é€ä¼˜æƒ åˆ¸

2. **ä»·å€¼å‹ç”¨æˆ·** (18%)
   - é«˜ä»˜è´¹ï¼Œé«˜ç•™å­˜
   - æœˆå‡æ¶ˆè´¹ï¼šÂ¥285
   - å»ºè®®ç­–ç•¥ï¼šVIPç‰¹æƒå¼ºåŒ–

3. **è§‚æœ›å‹ç”¨æˆ·** (35%)
   - ä¸­é¢‘è®¿é—®ï¼Œå¾…è½¬åŒ–
   - å¹³å‡è®¿é—®é¢‘æ¬¡ï¼š2.3æ¬¡/å‘¨
   - å»ºè®®ç­–ç•¥ï¼šå†…å®¹è¥é”€åŸ¹è‚²

4. **æ²‰ç¡å‹ç”¨æˆ·** (15%)
   - ä½æ´»è·ƒï¼Œé«˜æµå¤±é£é™©
   - æœ€è¿‘è®¿é—®ï¼š>14å¤©
   - å»ºè®®ç­–ç•¥ï¼šå¬å›æ´»åŠ¨

### 3.2 åŠŸèƒ½ä½¿ç”¨çƒ­åº¦

#### 3.2.1 Top 10 åŠŸèƒ½ä½¿ç”¨æ’è¡Œ

| æ’å | åŠŸèƒ½åç§° | ä½¿ç”¨ç‡ | å‘¨ç¯æ¯” | ç”¨æˆ·è¯„åˆ† |
| :---: | :--- | :---: | :---: | :---: |
| 1 | æ™ºèƒ½æ¨è | 78.5% | +5.2% â†—ï¸ | 4.6/5.0 â­ |
| 2 | æœç´¢åŠŸèƒ½ | 68.3% | +2.1% â†—ï¸ | 4.3/5.0 |
| 3 | ä¸ªäººä¸­å¿ƒ | 65.7% | -1.5% â†˜ï¸ | 4.2/5.0 |
| 4 | æ”¶è—å¤¹ | 52.4% | +8.7% â†—ï¸ | 4.5/5.0 â­ |
| 5 | åˆ†äº«åŠŸèƒ½ | 45.8% | +12.3% â†—ï¸ | 4.4/5.0 |
| 6 | è¯„è®ºäº’åŠ¨ | 38.9% | +3.4% â†—ï¸ | 4.1/5.0 |
| 7 | æ¶ˆæ¯é€šçŸ¥ | 35.2% | -2.8% â†˜ï¸ | 3.8/5.0 |
| 8 | è®¾ç½®ä¸­å¿ƒ | 28.6% | +0.5% | 4.0/5.0 |
| 9 | å¸®åŠ©ä¸­å¿ƒ | 18.7% | -4.2% â†˜ï¸ | 3.9/5.0 |
| 10 | åé¦ˆå…¥å£ | 12.3% | +1.8% â†—ï¸ | 4.2/5.0 |

#### 3.2.2 ç”¨æˆ·è·¯å¾„åˆ†æ

æœ€å¸¸è§çš„ç”¨æˆ·æµè§ˆè·¯å¾„ï¼ˆTop 5ï¼‰ï¼š

1. \`é¦–é¡µ â†’ æ¨è â†’ è¯¦æƒ… â†’ è¿”å›\` (32.5%)
2. \`é¦–é¡µ â†’ æœç´¢ â†’ è¯¦æƒ… â†’ æ”¶è—\` (18.7%)
3. \`é¦–é¡µ â†’ åˆ†ç±» â†’ åˆ—è¡¨ â†’ è¯¦æƒ…\` (15.2%)
4. \`é¦–é¡µ â†’ ä¸ªäººä¸­å¿ƒ â†’ å†å²è®°å½•\` (12.8%)
5. \`é¦–é¡µ â†’ æ´»åŠ¨é¡µ â†’ è¯¦æƒ… â†’ ä»˜è´¹\` (8.3%)

---

## 4. æŠ€æœ¯å®ç°ç»†èŠ‚

### 4.1 æ•°æ®é‡‡é›†æ¶æ„

#### 4.1.1 åŸ‹ç‚¹è®¾è®¡

å‰ç«¯åŸ‹ç‚¹é‡‡ç”¨æ··åˆæ¨¡å¼ï¼š**ä»£ç åŸ‹ç‚¹** + **å¯è§†åŒ–åŸ‹ç‚¹**

**æ ¸å¿ƒäº‹ä»¶å®šä¹‰ï¼š**

\`\`\`javascript
// é¡µé¢æµè§ˆäº‹ä»¶
window.analytics.track('page_view', {
  page_name: 'product_detail',
  page_url: window.location.href,
  referrer: document.referrer,
  timestamp: Date.now(),
  user_id: getCurrentUserId(),
  session_id: getSessionId(),
});

// ç”¨æˆ·è¡Œä¸ºäº‹ä»¶
window.analytics.track('button_click', {
  element_id: 'purchase_button',
  element_text: 'ç«‹å³è´­ä¹°',
  element_position: { x: 120, y: 450 },
  context: {
    product_id: '12345',
    product_price: 99.00,
    inventory: 'in_stock'
  }
});
\`\`\`

#### 4.1.2 æ•°æ®ä¼ è¾“

ä½¿ç”¨æ‰¹é‡ä¸ŠæŠ¥æœºåˆ¶ä¼˜åŒ–æ€§èƒ½ï¼š

\`\`\`typescript
interface EventBatch {
  events: Event[];
  device_info: DeviceInfo;
  user_info: UserInfo;
  batch_id: string;
  timestamp: number;
}

class Analytics {
  private buffer: Event[] = [];
  private readonly BATCH_SIZE = 20;
  private readonly FLUSH_INTERVAL = 5000; // 5ç§’
  
  track(eventName: string, properties: Record<string, any>) {
    const event: Event = {
      event_name: eventName,
      properties: properties,
      timestamp: Date.now(),
      event_id: generateUUID()
    };
    
    this.buffer.push(event);
    
    if (this.buffer.length >= this.BATCH_SIZE) {
      this.flush();
    }
  }
  
  private async flush() {
    if (this.buffer.length === 0) return;
    
    const batch: EventBatch = {
      events: [...this.buffer],
      device_info: getDeviceInfo(),
      user_info: getUserInfo(),
      batch_id: generateUUID(),
      timestamp: Date.now()
    };
    
    this.buffer = [];
    
    await fetch('/api/v1/analytics/collect', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(batch)
    });
  }
}
\`\`\`

### 4.2 æ•°æ®å¤„ç†æµç¨‹

#### 4.2.1 å®æ—¶è®¡ç®—

ä½¿ç”¨ Flink è¿›è¡Œå®æ—¶æŒ‡æ ‡è®¡ç®—ï¼š

\`\`\`sql
-- å®æ—¶æ´»è·ƒç”¨æˆ·ç»Ÿè®¡
SELECT 
  DATE_FORMAT(event_time, 'yyyy-MM-dd HH:mm:00') as window_time,
  COUNT(DISTINCT user_id) as active_users,
  COUNT(*) as total_events
FROM event_stream
WHERE event_name = 'page_view'
GROUP BY TUMBLE(event_time, INTERVAL '1' MINUTE)
\`\`\`

#### 4.2.2 ç¦»çº¿åˆ†æ

æ•°æ®ä»“åº“ ETL æµç¨‹ï¼š

\`\`\`python
# Airflow DAG å®šä¹‰
from airflow import DAG
from airflow.operators.python import PythonOperator
from datetime import datetime, timedelta

default_args = {
    'owner': 'data_team',
    'depends_on_past': False,
    'start_date': datetime(2025, 10, 1),
    'email_on_failure': True,
    'retries': 3,
    'retry_delay': timedelta(minutes=5)
}

dag = DAG(
    'user_behavior_analysis',
    default_args=default_args,
    schedule_interval='0 2 * * *',  # æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œ
    catchup=False
)

def extract_raw_data(**context):
    """ä» Kafka æå–åŸå§‹äº‹ä»¶æ•°æ®"""
    execution_date = context['execution_date']
    # å®ç°æ•°æ®æå–é€»è¾‘
    pass

def transform_data(**context):
    """æ•°æ®æ¸…æ´—å’Œè½¬æ¢"""
    # å»é‡ã€æ ¼å¼åŒ–ã€å­—æ®µæ˜ å°„
    pass

def load_to_warehouse(**context):
    """åŠ è½½åˆ°æ•°æ®ä»“åº“"""
    # å†™å…¥ Hive/ClickHouse
    pass

extract = PythonOperator(
    task_id='extract_raw_data',
    python_callable=extract_raw_data,
    dag=dag
)

transform = PythonOperator(
    task_id='transform_data',
    python_callable=transform_data,
    dag=dag
)

load = PythonOperator(
    task_id='load_to_warehouse',
    python_callable=load_to_warehouse,
    dag=dag
)

extract >> transform >> load
\`\`\`

### 4.3 å¯è§†åŒ–å®ç°

#### 4.3.1 å›¾è¡¨ç»„ä»¶

ä½¿ç”¨ ECharts å®ç°äº¤äº’å¼å›¾è¡¨ï¼š

\`\`\`javascript
const option = {
  title: {
    text: 'ç”¨æˆ·å¢é•¿è¶‹åŠ¿',
    subtext: 'è¿‘30å¤©æ•°æ®'
  },
  tooltip: {
    trigger: 'axis',
    axisPointer: { type: 'cross' }
  },
  legend: {
    data: ['æ–°å¢ç”¨æˆ·', 'DAU', 'MAU']
  },
  xAxis: {
    type: 'category',
    boundaryGap: false,
    data: ['10-01', '10-02', '...', '10-30']
  },
  yAxis: {
    type: 'value'
  },
  series: [
    {
      name: 'æ–°å¢ç”¨æˆ·',
      type: 'line',
      data: [1200, 1320, 1010, 1340, 1290, /* ... */],
      smooth: true,
      areaStyle: { opacity: 0.3 }
    }
  ]
};
\`\`\`

---

## 5. æ•°æ®æ¨¡å‹ä¸ç®—æ³•

### 5.1 ç•™å­˜ç‡è®¡ç®—

#### 5.1.1 ç»å…¸å®šä¹‰

Næ—¥ç•™å­˜ç‡çš„æ•°å­¦å®šä¹‰ï¼š

$$
\\text{Retention}_n = \\frac{\\text{Active Users on Day } n}{\\text{New Users on Day } 0} \\times 100\\%
$$

å…¶ä¸­ï¼š
- $n$ è¡¨ç¤ºè·ç¦»æ³¨å†Œçš„å¤©æ•°
- åˆ†å­ï¼šç¬¬ $n$ å¤©ä»æ´»è·ƒçš„ç”¨æˆ·æ•°
- åˆ†æ¯ï¼šç¬¬ 0 å¤©ï¼ˆæ³¨å†Œæ—¥ï¼‰çš„æ–°å¢ç”¨æˆ·æ•°

#### 5.1.2 æ”¹è¿›æ¨¡å‹

è€ƒè™‘ç”¨æˆ·è´¨é‡æƒé‡çš„ç•™å­˜ç‡ï¼š

$$
\\text{Weighted Retention}_n = \\frac{\\sum_{i=1}^{k} w_i \\cdot u_i}{\\sum_{i=1}^{k} w_i \\cdot U_i}
$$

å…¶ä¸­ï¼š
- $w_i$ æ˜¯ç¬¬ $i$ ä¸ªæ¸ é“çš„æƒé‡ç³»æ•°
- $u_i$ æ˜¯è¯¥æ¸ é“ç¬¬ $n$ å¤©çš„æ´»è·ƒç”¨æˆ·æ•°
- $U_i$ æ˜¯è¯¥æ¸ é“ç¬¬ 0 å¤©çš„æ–°å¢ç”¨æˆ·æ•°

### 5.2 ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ (LTV)

#### 5.2.1 åŸºç¡€å…¬å¼

$$
LTV = ARPU \\times \\frac{1}{Churn\\ Rate}
$$

è¯¦ç»†å±•å¼€ï¼š

$$
LTV = \\sum_{t=0}^{\\infty} \\frac{R_t \\times (1-c)^t}{(1+d)^t}
$$

å‚æ•°è¯´æ˜ï¼š
- $R_t$ï¼šç¬¬ $t$ æœŸçš„å¹³å‡æ”¶å…¥
- $c$ï¼šæµå¤±ç‡ (Churn Rate)
- $d$ï¼šæŠ˜ç°ç‡
- $(1-c)^t$ï¼šç¬¬ $t$ æœŸçš„ç•™å­˜ç‡

#### 5.2.2 é¢„æµ‹æ¨¡å‹

ä½¿ç”¨ Survival Analysisï¼ˆç”Ÿå­˜åˆ†æï¼‰é¢„æµ‹ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸï¼š

\`\`\`python
from lifelines import KaplanMeierFitter
import pandas as pd

# å‡†å¤‡æ•°æ®
df = pd.DataFrame({
    'duration': [1, 3, 5, 7, 10, 14, 21, 30],  # å¤©æ•°
    'observed': [1, 1, 1, 0, 1, 0, 1, 1]       # æ˜¯å¦æµå¤±
})

# æ‹Ÿåˆ Kaplan-Meier æ¨¡å‹
kmf = KaplanMeierFitter()
kmf.fit(df['duration'], event_observed=df['observed'])

# é¢„æµ‹ç”Ÿå­˜æ›²çº¿
survival_prob = kmf.survival_function_
print(f"30å¤©ç•™å­˜ç‡é¢„æµ‹: {survival_prob.loc[30].values[0]:.2%}")
\`\`\`

### 5.3 æ¨èç®—æ³•

#### 5.3.1 ååŒè¿‡æ»¤

åŸºäºç”¨æˆ·çš„ååŒè¿‡æ»¤ç›¸ä¼¼åº¦è®¡ç®—ï¼š

$$
sim(u, v) = \\frac{\\sum_{i \\in I_{uv}} (r_{ui} - \\bar{r}_u)(r_{vi} - \\bar{r}_v)}{\\sqrt{\\sum_{i \\in I_{uv}} (r_{ui} - \\bar{r}_u)^2} \\sqrt{\\sum_{i \\in I_{uv}} (r_{vi} - \\bar{r}_v)^2}}
$$

å…¶ä¸­ï¼š
- $I_{uv}$ï¼šç”¨æˆ· $u$ å’Œ $v$ å…±åŒè¯„ä»·è¿‡çš„ç‰©å“é›†åˆ
- $r_{ui}$ï¼šç”¨æˆ· $u$ å¯¹ç‰©å“ $i$ çš„è¯„åˆ†
- $\\bar{r}_u$ï¼šç”¨æˆ· $u$ çš„å¹³å‡è¯„åˆ†

#### 5.3.2 æ·±åº¦å­¦ä¹ æ¨¡å‹

ä½¿ç”¨åŒå¡”æ¨¡å‹ï¼ˆTwo-Tower Modelï¼‰ï¼š

\`\`\`python
import torch
import torch.nn as nn

class TwoTowerModel(nn.Module):
    def __init__(self, user_dim, item_dim, embedding_dim=128):
        super().__init__()
        
        # ç”¨æˆ·å¡”
        self.user_tower = nn.Sequential(
            nn.Linear(user_dim, 256),
            nn.ReLU(),
            nn.Dropout(0.2),
            nn.Linear(256, embedding_dim),
            nn.LayerNorm(embedding_dim)
        )
        
        # ç‰©å“å¡”
        self.item_tower = nn.Sequential(
            nn.Linear(item_dim, 256),
            nn.ReLU(),
            nn.Dropout(0.2),
            nn.Linear(256, embedding_dim),
            nn.LayerNorm(embedding_dim)
        )
    
    def forward(self, user_features, item_features):
        user_emb = self.user_tower(user_features)
        item_emb = self.item_tower(item_features)
        
        # ä½™å¼¦ç›¸ä¼¼åº¦
        similarity = torch.cosine_similarity(user_emb, item_emb, dim=-1)
        return similarity

# è®­ç»ƒç¤ºä¾‹
model = TwoTowerModel(user_dim=64, item_dim=48)
optimizer = torch.optim.Adam(model.parameters(), lr=0.001)
criterion = nn.BCEWithLogitsLoss()
\`\`\`

---

## 6. ä¼˜åŒ–å»ºè®®

### 6.1 çŸ­æœŸä¼˜åŒ– (1-2å‘¨)

#### 6.1.1 æ³¨å†Œæµç¨‹ä¼˜åŒ–

**é—®é¢˜è¯Šæ–­ï¼š**
- âŒ å½“å‰æ³¨å†Œéœ€è¦ 5 ä¸ªæ­¥éª¤ï¼Œå¹³å‡è€—æ—¶ 3.5 åˆ†é’Ÿ
- âŒ ç¬¬ä¸‰æ­¥ï¼ˆæ‰‹æœºéªŒè¯ï¼‰æµå¤±ç‡é«˜è¾¾ 42%
- âŒ è¡¨å•å­—æ®µè¿‡å¤šï¼Œç”¨æˆ·ä½“éªŒå·®

**ä¼˜åŒ–æ–¹æ¡ˆï¼š**

\`\`\`diff
æ³¨å†Œæµç¨‹æ”¹è¿›ï¼š
- æ­¥éª¤1ï¼šæ‰‹æœºå· + éªŒè¯ç ï¼ˆåˆå¹¶åŸæ­¥éª¤1å’Œ3ï¼‰
- æ­¥éª¤2ï¼šåŸºæœ¬ä¿¡æ¯ï¼ˆæ˜µç§°ã€å¯†ç ï¼‰
- æ­¥éª¤3ï¼šå®Œæˆ âœ“

åŸæµç¨‹ 5æ­¥ â†’ æ–°æµç¨‹ 3æ­¥
é¢„æœŸè½¬åŒ–ç‡æå‡ï¼š8-12%
\`\`\`

**å®æ–½æ¸…å•ï¼š**
- [x] äº§å“éœ€æ±‚è¯„å®¡
- [ ] UI è®¾è®¡ç¨¿è¾“å‡º
- [ ] å‰ç«¯å¼€å‘ï¼ˆé¢„è®¡2å¤©ï¼‰
- [ ] åç«¯æ¥å£è°ƒæ•´ï¼ˆé¢„è®¡1å¤©ï¼‰
- [ ] A/B æµ‹è¯•éªŒè¯
- [ ] å…¨é‡å‘å¸ƒ

#### 6.1.2 æ€§èƒ½ä¼˜åŒ–

å½“å‰é¡µé¢åŠ è½½æ€§èƒ½ï¼š

| æŒ‡æ ‡ | å½“å‰å€¼ | ç›®æ ‡å€¼ | ä¼˜åŒ–æ–¹å‘ |
| :--- | :---: | :---: | :--- |
| FCP | 1.8s | <1.0s | ä»£ç åˆ†å‰²ã€CDN åŠ é€Ÿ |
| LCP | 3.2s | <2.5s | å›¾ç‰‡æ‡’åŠ è½½ã€é¢„åŠ è½½ |
| TTI | 4.5s | <3.0s | JS ç˜¦èº«ã€å¼‚æ­¥åŠ è½½ |
| CLS | 0.15 | <0.1 | é¢„ç•™ç©ºé—´ã€å­—ä½“ä¼˜åŒ– |

### 6.2 ä¸­æœŸè§„åˆ’ (1-3ä¸ªæœˆ)

#### 6.2.1 ä¸ªæ€§åŒ–æ¨è

- ğŸ¯ **ç›®æ ‡**ï¼šå°†ç‚¹å‡»ç‡ä»å½“å‰ 2.8% æå‡è‡³ 4.5%
- ğŸ“Š **æ•°æ®åŸºç¡€**ï¼š
  - ç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼šâœ… å·²å®Œæˆé‡‡é›†
  - å†…å®¹æ ‡ç­¾ä½“ç³»ï¼šğŸ”„ å»ºè®¾ä¸­ï¼ˆ80%ï¼‰
  - ç”¨æˆ·ç”»åƒç³»ç»Ÿï¼šâœ… å·²ä¸Šçº¿
- ğŸ”§ **æŠ€æœ¯æ–¹æ¡ˆ**ï¼š
  - å¬å›å±‚ï¼šååŒè¿‡æ»¤ + å†…å®¹ç›¸ä¼¼åº¦
  - æ’åºå±‚ï¼šLightGBM + åŒå¡”æ·±åº¦æ¨¡å‹
  - é‡æ’å±‚ï¼šå¤šæ ·æ€§çº¦æŸ + ä¸šåŠ¡è§„åˆ™

#### 6.2.2 ç”¨æˆ·åˆ†å±‚è¿è¥

å»ºç«‹ RFM æ¨¡å‹è¿›è¡Œç”¨æˆ·åˆ†å±‚ï¼š

| ç”¨æˆ·åˆ†å±‚ | æœ€è¿‘è®¿é—®(R) | è®¿é—®é¢‘æ¬¡(F) | æ¶ˆè´¹é‡‘é¢(M) | è¿è¥ç­–ç•¥ |
| :--- | :---: | :---: | :---: | :--- |
| é‡è¦ä»·å€¼ | <7å¤© | >20æ¬¡ | >Â¥500 | VIP ç‰¹æƒ + ä¸“å±å®¢æœ |
| é‡è¦å‘å±• | <7å¤© | >15æ¬¡ | Â¥100-500 | æ¶ˆè´¹æ¿€åŠ± + ä¼šå‘˜æ¨è |
| é‡è¦ä¿æŒ | <14å¤© | 10-15æ¬¡ | >Â¥500 | å…³æ€€å›è®¿ + æ–°å“æ¨é€ |
| é‡è¦æŒ½ç•™ | >30å¤© | >20æ¬¡ | >Â¥500 | å¬å›æ´»åŠ¨ + ä¼˜æƒ åˆ¸ |
| ä¸€èˆ¬ä»·å€¼ | <7å¤© | 5-10æ¬¡ | Â¥50-100 | ä¼˜æƒ ä¿ƒé”€ + å¢å€¼æœåŠ¡ |
| ä¸€èˆ¬å‘å±• | <14å¤© | 5-10æ¬¡ | <Â¥50 | å†…å®¹åŸ¹è‚² + å¼•å¯¼æ¶ˆè´¹ |
| ä¸€èˆ¬ä¿æŒ | <30å¤© | 3-5æ¬¡ | Â¥50-100 | æ—¥å¸¸è§¦è¾¾ + æ´»åŠ¨æ¨é€ |
| ä¸€èˆ¬æŒ½ç•™ | >30å¤© | <5æ¬¡ | <Â¥50 | ä½æˆæœ¬å¬å› |

### 6.3 é•¿æœŸæˆ˜ç•¥ (3-12ä¸ªæœˆ)

#### 6.3.1 æ•°æ®ä¸­å°å»ºè®¾

æ„å»ºç»Ÿä¸€çš„æ•°æ®ä¸­å°ï¼Œæ”¯æ’‘å…¨ä¸šåŠ¡çº¿çš„æ•°æ®åº”ç”¨ï¼š

\`\`\`
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ä¸šåŠ¡åº”ç”¨å±‚                           â”‚
â”‚  [å®æ—¶å¤§å±] [æŠ¥è¡¨ç³»ç»Ÿ] [æ¨èç³»ç»Ÿ] [é£æ§ç³»ç»Ÿ]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æ•°æ®æœåŠ¡å±‚                           â”‚
â”‚  [æ ‡ç­¾æœåŠ¡] [ç”»åƒæœåŠ¡] [æŒ‡æ ‡æœåŠ¡] [ç®—æ³•æœåŠ¡]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æ•°æ®åŠ å·¥å±‚                           â”‚
â”‚  [å®æ—¶è®¡ç®—] [ç¦»çº¿æ‰¹å¤„ç†] [æµæ‰¹ä¸€ä½“] [æ¨¡å‹è®­ç»ƒ]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æ•°æ®å­˜å‚¨å±‚                           â”‚
â”‚  [Hive] [ClickHouse] [Redis] [ElasticSearch]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æ•°æ®é‡‡é›†å±‚                           â”‚
â”‚  [åŸ‹ç‚¹SDK] [Kafka] [Flume] [APIç½‘å…³]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
\`\`\`

#### 6.3.2 AI èƒ½åŠ›æå‡

æ¢ç´¢å‰æ²¿ AI æŠ€æœ¯åœ¨äº§å“ä¸­çš„åº”ç”¨ï¼š

1. **å¤§è¯­è¨€æ¨¡å‹ (LLM)**
   - æ™ºèƒ½å®¢æœå¯¹è¯
   - å†…å®¹ç”Ÿæˆè¾…åŠ©
   - è¯­ä¹‰æœç´¢ä¼˜åŒ–

2. **è®¡ç®—æœºè§†è§‰**
   - å›¾ç‰‡è´¨é‡æ£€æµ‹
   - å†…å®¹å®¡æ ¸è‡ªåŠ¨åŒ–
   - ä¸ªæ€§åŒ–å°é¢ç”Ÿæˆ

3. **å¤šæ¨¡æ€å­¦ä¹ **
   - å›¾æ–‡è”åˆæ¨è
   - è·¨æ¨¡æ€æ£€ç´¢
   - ç”¨æˆ·å…´è¶£ç†è§£

---

## é™„å½•

### A. æœ¯è¯­è¡¨

| æœ¯è¯­ | è‹±æ–‡å…¨ç§° | å«ä¹‰ |
| :--- | :--- | :--- |
| DAU | Daily Active Users | æ—¥æ´»è·ƒç”¨æˆ·æ•° |
| MAU | Monthly Active Users | æœˆæ´»è·ƒç”¨æˆ·æ•° |
| ARPU | Average Revenue Per User | æ¯ç”¨æˆ·å¹³å‡æ”¶å…¥ |
| LTV | Lifetime Value | ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ |
| RFM | Recency, Frequency, Monetary | æœ€è¿‘ã€é¢‘ç‡ã€é‡‘é¢æ¨¡å‹ |
| CTR | Click Through Rate | ç‚¹å‡»ç‡ |
| CVR | Conversion Rate | è½¬åŒ–ç‡ |
| GMV | Gross Merchandise Volume | æˆäº¤æ€»é¢ |

### B. æ•°æ®å­—å…¸

#### B.1 äº‹ä»¶è¡¨ç»“æ„

\`\`\`sql
CREATE TABLE event_log (
    event_id VARCHAR(64) PRIMARY KEY COMMENT 'äº‹ä»¶å”¯ä¸€ID',
    user_id VARCHAR(64) NOT NULL COMMENT 'ç”¨æˆ·ID',
    session_id VARCHAR(64) NOT NULL COMMENT 'ä¼šè¯ID',
    event_name VARCHAR(128) NOT NULL COMMENT 'äº‹ä»¶åç§°',
    event_time TIMESTAMP NOT NULL COMMENT 'äº‹ä»¶æ—¶é—´',
    page_url VARCHAR(512) COMMENT 'é¡µé¢URL',
    referrer VARCHAR(512) COMMENT 'æ¥æºé¡µé¢',
    properties JSON COMMENT 'äº‹ä»¶å±æ€§ï¼ˆJSONæ ¼å¼ï¼‰',
    device_type VARCHAR(32) COMMENT 'è®¾å¤‡ç±»å‹',
    os VARCHAR(32) COMMENT 'æ“ä½œç³»ç»Ÿ',
    browser VARCHAR(32) COMMENT 'æµè§ˆå™¨',
    ip_address VARCHAR(64) COMMENT 'IPåœ°å€',
    geo_city VARCHAR(64) COMMENT 'åŸå¸‚',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_user_time (user_id, event_time),
    INDEX idx_event_name (event_name),
    INDEX idx_session (session_id)
) COMMENT='ç”¨æˆ·è¡Œä¸ºäº‹ä»¶è¡¨';
\`\`\`

### C. å‚è€ƒèµ„æ–™

1. **ä¹¦ç±æ¨è**
   - ã€Šç²¾ç›Šæ•°æ®åˆ†æã€‹ - Alistair Croll & Benjamin Yoskovitz
   - ã€Šå¢é•¿é»‘å®¢ã€‹ - Sean Ellis & Morgan Brown
   - ã€Šæ•°æ®é©±åŠ¨å¢é•¿ã€‹ - Andy Johns

2. **åœ¨çº¿èµ„æº**
   - [Google Analytics Academy](https://analytics.google.com/analytics/academy/)
   - [Mixpanel Product Analytics Guide](https://mixpanel.com/topics/)
   - [Amplitude Playbook](https://amplitude.com/books)

3. **å·¥å…·æ¨è**
   - æ•°æ®åˆ†æï¼šTableau, Metabase, Superset
   - åŸ‹ç‚¹ç®¡ç†ï¼šSegment, RudderStack
   - A/B æµ‹è¯•ï¼šOptimizely, VWO

---

## æ›´æ–°æ—¥å¿—

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ | ä½œè€… |
| :---: | :--- | :--- | :--- |
| v3.0 | 2025-10-29 | æ–°å¢ AI ç­–ç•¥è§„åˆ’ç« èŠ‚ | æ•°æ®å›¢é˜Ÿ |
| v2.5 | 2025-10-22 | ä¼˜åŒ–ç•™å­˜ç‡è®¡ç®—æ¨¡å‹ | å¼ ä¸‰ |
| v2.0 | 2025-10-15 | æ–°å¢ç”¨æˆ·åˆ†å±‚è¿è¥æ–¹æ¡ˆ | æå›› |
| v1.0 | 2025-10-08 | åˆå§‹ç‰ˆæœ¬å‘å¸ƒ | ç‹äº” |

---

<div style="text-align: center; color: #666; margin-top: 50px;">
  
**æ„Ÿè°¢é˜…è¯»æœ¬æŠ¥å‘Šï¼**

å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»æ•°æ®å›¢é˜Ÿï¼šdata-team@example.com

*æœ¬æŠ¥å‘Šç”± ValidFlow AI æ•°æ®åˆ†æå¹³å°è‡ªåŠ¨ç”Ÿæˆ*

</div>
`

export default mockMarkdown
